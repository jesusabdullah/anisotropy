% COMSOL Multiphysics Model M-file
% Generated by COMSOL 3.5a (COMSOL 3.5.0.608, $Date: 2009/05/11 07:38:49 $)
% Some geometry objects are stored in a separate file.
% The name of this file is given by the variable 'flbinaryfile'.

flclear fem

% COMSOL version
clear vrsn
vrsn.name = 'COMSOL 3.5';
vrsn.ext = 'a';
vrsn.major = 0;
vrsn.build = 608;
vrsn.rcs = '$Name: v35ap $';
vrsn.date = '$Date: 2009/05/11 07:38:49 $';
fem.version = vrsn;

flbinaryfile='';

% Geometry
clear draw
g9=flbinary('g9','draw',flbinaryfile);
g7=flbinary('g7','draw',flbinaryfile);
g8=flbinary('g8','draw',flbinaryfile);
g6=flbinary('g6','draw',flbinaryfile);
g5=flbinary('g5','draw',flbinaryfile);
g4=flbinary('g4','draw',flbinaryfile);
g3=flbinary('g3','draw',flbinaryfile);
draw.p.objs = {g9,g7,g8,g6,g5,g4,g3};
draw.p.name = {'PT6','PT4','PT5','PT3','PT2','PT1','ORIGIN'};
draw.p.tags = {'g9','g7','g8','g6','g5','g4','g3'};
g2=flbinary('g2','draw',flbinaryfile);
g1=flbinary('g1','draw',flbinaryfile);
draw.s.objs = {g2,g1};
draw.s.name = {'NEEDLE','SNOW'};
draw.s.tags = {'g2','g1'};
fem.draw = draw;
fem.geom = flbinary('g10','geom',flbinaryfile);
fem.mesh = flbinary('m1','mesh',flbinaryfile);

% (Default values are not included)

% Application mode 1
clear appl
appl.mode.class = 'GeneralHeat';
appl.module = 'HT';
clear shape
shape.default = {'shlag(1,''J'')','shlag(2,''T'')'};
shape.case = {{'shlag(1,''J'')','shlag(1,''T'')'}};
shape.mind = {[1]};
appl.shape = shape;
clear gporder
gporder.default = 4;
gporder.case = {2};
gporder.mind = {[1]};
appl.gporder = gporder;
clear cporder
cporder.default = 2;
cporder.case = {1};
cporder.mind = {[1]};
appl.cporder = cporder;
appl.sshape = 2;
appl.assignsuffix = '_htgh';
clear bnd
bnd.type = {'q0','cont'};
bnd.shape = 1;
bnd.ind = [1,1,1,1,2,2,2,2,2,1,1,1,1,2];
appl.bnd = bnd;
clear equ
equ.sdtype = 'gls';
equ.rho = {200,8000};
equ.init = 0;
equ.shape = 2;
equ.C = {2050,460};
equ.Q = {0,2546479.089470326};
equ.k = {{0.3;0.3;0.1},160};
equ.ind = [1,2];
appl.equ = equ;
fem.appl{1} = appl;
fem.frame = {'ref'};
fem.border = 1;
fem.outform = 'general';
clear units;
units.basesystem = 'SI';
fem.units = units;

% Coupling variable elements
clear elemcpl
% Integration coupling variables
clear elem
elem.elem = 'elcplscalar';
elem.g = {'1'};
src = cell(1,1);
clear bnd
bnd.expr = {{'T',{}},{'1',{}}};
bnd.ipoints = {{'4',{}},{'4',{}}};
bnd.frame = {{'ref',{}},{'ref',{}}};
bnd.ind = {{'1','2','3','4','10','11','12','13'},{'5','6','7','8','9', ...
  '14'}};
src{1} = {{},{},bnd,{}};
elem.src = src;
geomdim = cell(1,1);
geomdim{1} = {};
elem.geomdim = geomdim;
elem.var = {'int_T','area'};
elem.global = {'1','2'};
elem.maxvars = {};
elemcpl{1} = elem;
fem.elemcpl = elemcpl;

% ODE Settings
clear ode
clear units;
units.basesystem = 'SI';
ode.units = units;
fem.ode=ode;

% Multiphysics
fem=multiphysics(fem);

% Extend mesh
fem.xmesh=meshextend(fem, ...
                     'mcase',[0]);

% Solve problem
fem.sol=femstatic(fem, ...
                  'solcomp',{'T'}, ...
                  'outcomp',{'T'}, ...
                  'blocksize','auto');

% Save current fem structure for restart purposes
fem0=fem;

% Plot solution
postplot(fem, ...
         'slicedata',{'T','cont','internal','unit','K'}, ...
         'slicexspacing',5, ...
         'sliceyspacing',0, ...
         'slicezspacing',0, ...
         'slicemap','Rainbow', ...
         'title','Slice: Temperature [K]', ...
         'grid','on', ...
         'campos',[-4.263905480388432,-4.121579821719482,3.5821350139295745], ...
         'camtarget',[0,0,0], ...
         'camup',[0.5784077182862448,0.1047316506328266,0.8089967816886687], ...
         'camva',7.6936283778292);

% Plot solution
postplot(fem, ...
         'isodata',{'T','cont','internal','unit','K'}, ...
         'isolevels',5, ...
         'isomap','Rainbow', ...
         'isostriptol',0.01, ...
         'title','Isosurface: Temperature [K]', ...
         'grid','on', ...
         'campos',[1.0974146952569224,3.3237025813993095,-5.979020284925124], ...
         'camtarget',[0,0,0], ...
         'camup',[0.07301868049482817,-0.8773297347187593,-0.47430033615537925], ...
         'camva',7.4991976963260125);

% Plot solution
postplot(fem, ...
         'slicedata',{'T','cont','internal','unit','K'}, ...
         'slicexspacing',5, ...
         'sliceyspacing',0, ...
         'slicezspacing',0, ...
         'slicemap','Rainbow', ...
         'title','Slice: Temperature [K]', ...
         'grid','on', ...
         'campos',[6.9194230483525985,0.2592962721100117,-0.2331341924929586], ...
         'camtarget',[0,0,0], ...
         'camup',[0.04863729207490413,-0.8896219111370515,0.4541005054439824], ...
         'camva',7.499197696325951);

% Plot solution
postplot(fem, ...
         'slicedata',{'T','cont','internal','unit','K'}, ...
         'slicexspacing',1, ...
         'sliceyspacing',0, ...
         'slicezspacing',0, ...
         'slicemap','Rainbow', ...
         'title','Slice: Temperature [K]', ...
         'grid','on', ...
         'campos',[0.7195448353721174,2.476852174538043,-6.430199061140201], ...
         'camtarget',[0,0,0], ...
         'camup',[0.8101012220798917,-0.5717874243611236,-0.1295961084567674], ...
         'camva',7.499197696325949);

% Plot solution
postplot(fem, ...
         'slicedata',{'T','cont','internal','unit','K'}, ...
         'slicexspacing',1, ...
         'sliceyspacing',0, ...
         'slicezspacing',0, ...
         'slicemap','Rainbow', ...
         'title','Slice: Temperature [K]', ...
         'grid','on', ...
         'campos',[0.7195448353721174,2.476852174538043,-6.430199061140201], ...
         'camtarget',[0,0,0], ...
         'camup',[0.8101012220798917,-0.5717874243611236,-0.1295961084567674], ...
         'camva',7.499197696325949);

% Plot solution
postplot(fem, ...
         'slicedata',{'T','cont','internal','unit','K'}, ...
         'slicexspacing',1, ...
         'sliceyspacing',0, ...
         'slicezspacing',0, ...
         'slicemap','Rainbow', ...
         'title','Slice: Temperature [K]', ...
         'grid','on', ...
         'campos',[0.621080025445036,-0.0013099963500041376,0.0026529931746139684], ...
         'camtarget',[2.0424607845984798E-5,-0.0011587754850828954,6.20691085515958E-4], ...
         'camup',[-0.001359048863317982,-0.9384211879380219,0.3454907046726137], ...
         'camva',7.499197696326);
